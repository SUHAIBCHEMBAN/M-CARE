{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>M-CARE Multi National Clinic</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link rel="icon" type="image/png" href="{% static 'image/M-CARE logo.png' %}"/>
    <style>
      body {
        background-color: #f7f7fa;
        color:#008080;
      }
      .nav-link {
        font-size: 1.2rem;
        color: #fff;
        text-decoration: none; 
        position: relative; 
        transition: color 0.3s;   
    }
    
    .nav-link::after {
        content: '';
        position: absolute;
        width: 0;
        height: 2px;
        bottom: 0;
        left: 0;
        background-color: #fff; 
        transition: width 0.3s; 
    }
    
    .nav-link:hover {
        color: #fff; 
    }
    .nav-link:hover::after {
        width: 100%; 
    }
      .card {
        border:solid 0.1px #0002;
        border-radius:5px;
        box-shadow: 4px 4px 4px rgba(0, 0, 0, 0.1);
      }

      .card:hover {
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
      }

      .card-title {
        font-size: 1.2rem;
        font-weight: bold;
      }

      .card-text {
        font-size: 1rem;
        color: #008080;
      }
      .card img {
        object-fit: cover;
      }
      .btn {
        transition: all .6s ease;
        border-radius:5px;
        background-color:#008080;
        border:solid 1px #008080;
        color: white;
        font-family: "Trebuchet MS", "Lucida Sans Unicode", "Lucida Grande",
          "Lucida Sans", Arial, sans-serif;
        width:40%;
      }

      .btn:hover, .btn:focus{
        color:#fff;
        background-color:#008080;
        border:solid 1px #008080;
        border-radius:5px;
        width: 100%;
      }
      .bg-dark-opacity {
        background-color: rgba(0, 0, 0, 0.5); 
        padding: 10px;
        border-radius: 10px; 
    }
    .profile {
      margin-left:10px;
    }

  select, input {
      width: 100%; 
      padding: 10px; 
      font-size: 16px; 
      font-weight: 500;
      border-radius: 5px; 
      border: 1px solid #ccc; 
      box-sizing: border-box; 
      margin-top: 5px;
  }
  select option{
    opacity:.6;
  }

  input[type="submit"] {
      background-color:#008080;
      border:solid 1px #008080;
      color: #fff;
      border-radius: 5px;
      cursor: pointer;
      width:20%;
      height:5%;
      margin-top:4px;
      margin-left:3px;
      transition:all .5s ease;
  }

  input[type="submit"]:hover {
      background-color:#008080;
      border:solid 1px #008080;
      width:40%;
  }

    @media (max-width:350px){
      .l{
        display:block;
        font-size:80%;
      }
    }

   @media (max-width:990px){
    .crd3 {
      display:flex;
      margin:auto;
      justify-content:center;
    }
    #top{
      display: none;
    }
    .profile{
      display:none;
    }
    #profile{
      display:block;
    }
   }
   
   @media (min-width: 991px) {
    #profile {
      display: none; 
    }

    .nav button{
      display:none;
    }

    .navbar-toggler-icon{
      display:none;
    }
}
   @media (min-width: 400px) and (max-width: 450px) {
    .btn {
        margin-top: -20px;
    }
    .card-body {
        padding: 10px;
    }
    #profile{
      margin-top:25%;
    }
}
@media (max-width: 768px) {
  .foot_right, .foot_left {
    text-align: center;
  }

  .logos {
    justify-content: center !important;
  }

  .foot_left h5 {
    margin-top: 1rem;
  }
}

    </style>
  </head>
  <body>

{% if message %}
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
  <script>
    // Wait for the DOM to be fully loaded
    document.addEventListener('DOMContentLoaded', function () {
      // Display the SweetAlert toast message
      Swal.fire({
        icon: 'success',
        title: '{{ message }}',
        showConfirmButton: false,
        timer: 5000 // Auto hide after 5 seconds
      });
    });
  </script>
{% endif %}


<!-------------Navbar------------------>

<nav class="navbar navbar-expand-lg sticky-top d-flex"style="background-color:#008080;" height:"5.5rem;">
  <div class="container">
    <h1><a class="navbar-brand" href="{% url 'home' %}" style="color:#fff; font-size: 2.5rem;">M-CARE</a></h1>
    <button class="navbar-toggler  d-flex  border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon mt-2"></span>
      <div class="nav-item" id="profile">
      {% if user.is_authenticated %}
        {% if user.userprofile.profile_picture %}
        <a class="btn btn-dark rounded-circle d-flex justify-content-center align-items-center ms-3" href="{% url 'profile' %}" style="width: 40px; height: 40px">
          <img src="{{ user.userprofile.profile_picture.url }}" class="rounded-circle" style="width: 40px; height: 40px" />
        </a>
        {% else %}
        <a class="btn btn-light rounded-circle d-flex justify-content-center align-items-center ms-3" href="{% url 'profile' %}" style="width: 40px; height: 40px">
          <img src="{% static 'image/user.jpg' %}" class="rounded-circle" style="width: 40px; height: 40px" />
        </a>
        {% endif %}
      {% else %}
        <a class="btn btn-light rounded-circle d-flex justify-content-center align-items-center ms-3" href="{% url 'login' %}" style="width: 40px; height: 40px">
          <img src="{% static 'image/user.jpg' %}" class="rounded-circle" style="width: 40px; height: 40px" />
        </a>
      {% endif %}
      </div> 
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav mx-auto" style="text-align: center; color: blue;">
        <li class="nav-item">
          <a class="nav-link" href="{% url 'doctors' %}">Doctors</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'aboutus' %}">About Us</a>
        </li> 
        <li class="nav-item">
          <a class="nav-link" href="{% url 'student_admission' %}">AdmissionOpen</a>
        </li>
      </ul>
    </div>
    <div class="profile d-flex"><!-- Booking Icon -->
      <a class="btn btn-light rounded-circle d-flex justify-content-center align-items-center ms-3" href="{% url 'booking' %}" style="width: 40px; height: 40px;">
        <i class="fas fa-calendar-alt" style="font-size: 1.5rem; color:#fff;"></i>
      </a>
      {% if user.is_authenticated %}
        {% if user.userprofile.profile_picture %}
        <a class="btn btn-dark rounded-circle d-flex justify-content-center align-items-center ms-3" href="{% url 'profile' %}" style="width: 40px; height: 40px">
          <img src="{{ user.userprofile.profile_picture.url }}" class="rounded-circle" style="width: 40px; height: 40px" />
        </a>
        {% else %}
        <a class="btn btn-light rounded-circle d-flex justify-content-center align-items-center ms-3" href="{% url 'profile' %}" style="width: 40px; height: 40px">
          <img src="{% static 'image/user.jpg' %}" class="rounded-circle" style="width: 40px; height: 40px" />
        </a>
        {% endif %}
      {% else %}
        <a class="btn btn-light rounded-circle d-flex justify-content-center align-items-center ms-3" href="{% url 'login' %}" style="width: 40px; height: 40px">
          <img src="{% static 'image/user.jpg' %}" class="rounded-circle" style="width: 40px; height: 40px" />
        </a>
      {% endif %}
      
    </div>
  </div>
</nav>

   <!------------carousel------------>
 
   <div id="carouselExampleAutoplaying" class="carousel slide" data-bs-ride="carousel" data-bs-interval="3000">
    <div class="carousel-inner">
      {% for ban in banner %}
        <div class="carousel-item {% if forloop.first %}active{% endif %}">
          <img src="{{ ban.image.url }}" class="d-block w-100" alt="something went wrong"/>
          <div class="carousel-caption d-none d-md-block">
            <h4 class="text-light bg-dark-opacity">
              {{ ban.title }}
            </h4>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
  
    <!------------Cards-------------->

    <div class="container mt-5">
      <div class="row">
        {% for mcrd in main_crd %}
        <div class="col-12 col-md-6 col-lg-4">
          <div class="card my-3" style="height:24rem;">
            <img src="{{ mcrd.crd_img.url }}" class="card-img-top" alt="something went wrong">
            <div class="card-body text-center">
              <h5 class="card-title">{{ mcrd.title}}</h5>
              <p class="card-text">{{ mcrd.discription}}</p>
              <a href="{{mcrd.button_url}}" class="btn">{{mcrd.button}}</a>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  
    <!---Search Bar ---->
  
  <div class="container d-flex mt-5" id="search"> 
      <form method="post" class="p-3 w-100" id="findDoctorForm">
          {% csrf_token %}
          <div class="d-flex justify-content-between" style="width: 100%;">
              <div style="width: 100%;">
                  <select id="location" name="location">
                      <option value="" disabled selected>Select Your Location</option> 
                      {% for location in locations %}
                          {% if location == selected_location %}
                              <option value="{{ location.id }}" selected>{{ location.name }}</option>
                          {% else %}
                              <option value="{{ location.id }}">{{ location.name }}</option>
                          {% endif %}
                      {% endfor %}
                  </select>
              </div>&nbsp;
              <div style="width: 100%;">
                  <select id="department" name="department">
                      <option value="" disabled selected>Select Your Department</option> 
                      {% for department in departments %}
                          <option value="{{ department.id }}">{{ department.name }}</option>
                      {% endfor %}
                  </select>
              </div>
              <input type="submit" value="Search">
          </div>
      </form>
  </div>

  <!-- Modal -->
  <div class="modal fade" id="alertModal" tabindex="-1" aria-labelledby="alertModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-center" id="alertModalLabel">Something Went Wrong</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                You Not Selected Any Location , Must select a Location.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

  <!----- Location Card ---->

  <div class="container my-5  pb-5 text-center" id="loc">
    <h2 class="text-center ">M-CARE Clinic Near You</h2>
      <div class="row mt-5">
        {% for loc_img in location_img %}
          <div class="col-12 col-md-6 col-lg-4">
            <div class="card my-3" style="height:15rem;">
              <a href="{{ loc_img.click_url }}">
                <img src="{{ loc_img.image.url }}" class="card-img-top" alt="something went wrong" style="height:10rem;">
              </a>
              <div class="card-body">
                <h5 class="card-title">{{loc_img.title}}</h5>
              </div> 
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  
    <!--------------Footer------------------>

    <footer class="p-5 w-100 d-flex flex-wrap justify-content-between align-items-center border-bottom" style="background-color:#008080; color:#fff;">
      <div class="foot_right w-100 w-md-50">
        <p>Do you have any Emergency? Call these Numbers:</p>
        <p><i class="fas fa-phone-alt"></i>&nbsp;+91 9947896956 (IND)</p>
        <p><i class="fas fa-phone-alt"></i>&nbsp;+1 9345834572 (CND)</p>
        <p><i class="fas fa-phone-alt"></i>&nbsp;+966 994738539 (UAE)</p>
      </div>
      <div class="foot_left w-100 w-md-50 mt-4 mt-md-0">
        <div class="logos d-flex justify-content-center justify-content-md-end">
          <a href="#" class="text-white mx-2"><i class="fab fa-whatsapp fa-lg"></i></a>
          <a href="#" class="text-white mx-2"><i class="fab fa-facebook-f fa-lg"></i></a>
          <a href="#" class="text-white mx-2"><i class="fab fa-instagram fa-lg"></i></a>
        </div>
        <br>
        <h5 class="text-center text-md-end">M-CARE Multi National Clinic Pvt. Ltd</h5>
      </div>
    </footer>
    
    <footer class="py-3 text-white text-center" style="background-color:#008080; color:#fff;">
      <p>&copy; M-CARE CLINIC 2024 Hospital Management. All rights reserved.</p>
    </footer>

    

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
      // JavaScript function to validate the form
      function validateForm(event) {
        var location = document.getElementById('location').value;
        var department = document.getElementById('department').value;
        
        if (!location) {
            event.preventDefault(); // Prevent form submission
            var myModal = new bootstrap.Modal(document.getElementById('alertModal'));
            myModal.show();
        }
    }

    // Function to fetch departments for the selected location
    function fetchDepartments() {
        var locationId = document.getElementById('location').value;
        var departmentSelect = document.getElementById('department');

        // Clear existing options
        departmentSelect.innerHTML = '';

        // Make AJAX request to fetch departments
        fetch('/api/departments/' + locationId + '/')
            .then(response => response.json())
            .then(data => {
                // Add new options to the department dropdown
                data.forEach(department => {
                    var option = document.createElement('option');
                    option.value = department.id;
                    option.textContent = department.name;
                    departmentSelect.appendChild(option);
                });
            })
            .catch(error => console.error('Error fetching departments:', error));
    }

    // Add event listener to the location dropdown
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('location').addEventListener('change', fetchDepartments);
        document.getElementById('findDoctorForm').addEventListener('submit', validateForm);

        // Call fetchDepartments function on page load if location is selected
        if (document.getElementById('location').value) {
            fetchDepartments();
        }
    });
    </script>
  </body>
</html>
